{"version":3,"sources":["../src/angularTemplate.js"],"names":[],"mappings":"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","file":"angularTemplate.js","sourcesContent":["import React, { PropTypes as t } from 'react';\nimport angular from 'angular';\n\n// Stolen from ReactCOMComponent (it does not expose it)\nfunction isCustomComponent(tagName, props) {\n  return tagName.indexOf('-') >= 0 || props.is != null;\n}\n\nexport default class ReactAngular extends React.Component {\n  componentDidMount() {\n    const { controller, controllerAs, inject, isolate, scope, template, templateUrl } = this.props;\n\n    const parentScope = this.$element.scope();\n    const $injector = this.$element.injector();\n\n    const $controller = $injector.get('$controller');\n    const $compile = $injector.get('$compile');\n    const $rootScope = $injector.get('$rootScope');\n    const $templateCache = $injector.get('$templateCache');\n\n    this.$scope = scope ? parentScope.$new(isolate) : parentScope;\n\n    if (angular.isObject(scope)) {\n      angular.extend(this.$scope, scope);\n    }\n\n    const actualTemplateFunc = template || (templateUrl ? $templateCache.get(templateUrl) : null);\n\n    const actualTemplate = angular.isFunction(actualTemplateFunc)\n      ? actualTemplateFunc(inject)\n      : actualTemplateFunc;\n\n    if (controller) {\n      const instantiatedController = $controller(controller, {\n        ...inject,\n        $scope: this.$scope,\n        $element: this.$element,\n      });\n\n      if (controllerAs) {\n        this.$scope[controllerAs] = instantiatedController;\n      }\n    }\n\n    if (actualTemplate) {\n      this.$element.append(actualTemplate);\n    }\n\n    $compile(this.$element)(this.$scope);\n    $rootScope.$evalAsync();\n  }\n\n  shouldComponentUpdate() {\n    return false;\n  }\n\n  render() {\n    const { wrapperTag, className, wrapperAttrs, children } = this.props;\n    const ref = (element) => this.$element = angular.element(element);\n\n    if (children) {\n      if (!React.isValidElement(children)) {\n        throw new Error(`Only one child is allowed in AngularTemplate.\n          Found ${children.length}: ${children.map(({type}) => type).join(', ')}.`);\n      }\n\n      const classesKey = isCustomComponent(children.type, children.props) ? 'class' : 'className';\n      const classes = {\n        [classesKey]: [className || '', children.props.className || '', children.props['class'] || '']\n          .join(' ')\n          .trim() || undefined,\n      };\n\n      const child = React.cloneElement(children, {\n        ...wrapperAttrs,\n        ref,\n        ...classes,\n      });\n\n      return child;\n    }\n\n    const classesKey = isCustomComponent(wrapperTag, wrapperAttrs) ? 'class' : 'className';\n    const classes = {\n      [classesKey]: [className || '', wrapperAttrs.className || '', wrapperAttrs['class'] || '']\n        .join(' ')\n        .trim() || undefined,\n    };\n\n    return React.createElement(wrapperTag, {\n      ...wrapperAttrs,\n      ref,\n      ...classes,\n    }, '');\n  }\n}\n\nReactAngular.propTypes = {\n  className: t.string,\n  children: t.node,\n  controller: t.any,\n  controllerAs: t.string,\n  inject: t.object,\n  isolate: t.bool,\n  scope: t.oneOfType([t.bool, t.object]),\n  template: t.oneOfType([t.string, t.func]),\n  templateUrl: t.string,\n  wrapperTag: t.string,\n  wrapperAttrs: t.object,\n};\n\nReactAngular.defaultProps = {\n  inject: {},\n  isolate: false,\n  scope: true,\n  wrapperTag: 'div',\n  wrapperAttrs: {},\n};\n"]}